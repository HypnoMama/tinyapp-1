<!DOCTYPE html>
<html lang="en">
  <%- include ("partials/_head") %>

  <body>
    <%- include ("partials/_header") %>
    <div class="container my-3">
      <div class="card text-center">
        <div class="card-header"></div>
        <div class="card-body">
          <h5 class="card-title">
            TinyURL for: <a href="<%= url.longURL %>"><%= url.longURL %></a>
          </h5>
          <p class="card-text">
            Short URL:
            <a href="/u/<%= shortURL %>"><%= "/u/" + shortURL %></a> created <%=
            url.created.split(' ').slice(0, 5).join(' ') %>
          </p>
          <div class="tags">
            <button class="btn btn-primary">
              Total Visits
              <span class="badge badge-light"><%= visits.length %></span>
            </button>
            <button class="btn btn-primary">
              Unique Visits
              <span class="badge badge-light"><%= uniques %></span>
            </button>
          </div>
        </div>
        <div class="card-footer text-muted">
          <h3>Edit</h3>
          <hr />
          <form
            class="form"
            method="POST"
            action="/urls/<%= shortURL %>?_method=PUT"
          >
            <div class="form-group my-2">
              <label for="longURL">New URL: </label>
              <input
                type="url"
                class="form-control"
                name="longURL"
                value="https://"
                required
                pattern="https?://.+"
              />
            </div>
            <button type="submit" class="btn btn-primary my-3 float-right">
              Update
            </button>
          </form>
        </div>
      </div>
      <div class="container card">
        <h3 class="mt-4">Last 20 Visits to This Short URL</h3>
        <table class="table table-striped table-hover table-responsive-sm">
          <!-- <p class="text-muted hide-tablet">
            Table below is scrollable
            <i class="fa fa-long-arrow-right arrow" aria-hidden="true"></i>
          </p> -->
          <!-- user,
        url,
        shortURL,
        visits,
        uniques,
        alerts -->
          <thead class="table-head-dark">
            <tr>
              <th scope="col">Visitor ID:</th>
              <th scope="col">Timestamp:</th>
            </tr>
          </thead>
          <tbody>
            <% for (let i = 0; i < visits.length && i < 20; i++) { %>
            <tr>
              <td><%= visits[i].id %></td>
              <td><%= visits[i].timestamp %></td>
            </tr>
            <% } %>
          </tbody>
        </table>
      </div>
    </div>
    <%- include ("partials/_footer") %>
  </body>
</html>
